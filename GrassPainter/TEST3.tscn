[gd_scene load_steps=20 format=3 uid="uid://g32o4aono37x"]

[ext_resource type="Script" path="res://scripts/example_of_use.gd" id="1_4lo3h"]
[ext_resource type="Shader" path="res://scripts/world_painter.gdshader" id="1_t5wjv"]
[ext_resource type="Texture2D" uid="uid://rump6jx00yui" path="res://Images/splash_gradient.png" id="3_7s1uc"]
[ext_resource type="Texture2D" uid="uid://d2kgq7kogm4s4" path="res://Images/base_texture.png" id="3_eju3o"]
[ext_resource type="Script" path="res://scripts/image_processing.gd" id="4_enbqc"]
[ext_resource type="QuadMesh" uid="uid://b423fl0q8kufw" path="res://Meshes/grass.tres" id="6_bd65r"]
[ext_resource type="QuadMesh" uid="uid://blcwemantxp1q" path="res://Meshes/grass_small.tres" id="7_14s3h"]
[ext_resource type="Script" path="res://multi_grass_instance.gd" id="9_bnb8k"]
[ext_resource type="Script" path="res://res_grass_variant_info.gd" id="9_n4h14"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_brdqo"]
render_priority = 0
shader = ExtResource("1_t5wjv")
shader_parameter/splash_position = Vector2(1, 1)
shader_parameter/splash_scale = 1.0
shader_parameter/splash_color = Color(0.690196, 0.854902, 0.780392, 1)
shader_parameter/reveal_factor = 0.0
shader_parameter/splash_texture = ExtResource("3_7s1uc")
shader_parameter/color_root_map = ExtResource("3_eju3o")

[sub_resource type="PlaneMesh" id="PlaneMesh_74vs6"]
material = SubResource("ShaderMaterial_brdqo")

[sub_resource type="BoxShape3D" id="BoxShape3D_0prmi"]
size = Vector3(2, 0.1, 2)

[sub_resource type="MultiMesh" id="MultiMesh_5kxa4"]
transform_format = 1
instance_count = 19
mesh = ExtResource("6_bd65r")
buffer = PackedFloat32Array(1, 0, 0, 0.747116, 0, 1, 0, 0, 0, 0, 1, 1.76334, 1, 0, 0, 1.21311, 0, 1, 0, 0, 0, 0, 1, 0.812889, 1, 0, 0, 1.01483, 0, 1, 0, 0, 0, 0, 1, 1.41711, 1, 0, 0, 0.73293, 0, 1, 0, 0, 0, 0, 1, 1.15547, 1, 0, 0, 0.919803, 0, 1, 0, 0, 0, 0, 1, 0.810313, 1, 0, 0, 1.04519, 0, 1, 0, 0, 0, 0, 1, 0.811295, 1, 0, 0, 0.848638, 0, 1, 0, 0, 0, 0, 1, 0.964077, 1, 0, 0, 0.815448, 0, 1, 0, 0, 0, 0, 1, 1.26882, 1, 0, 0, 0.957079, 0, 1, 0, 0, 0, 0, 1, 1.47607, 1, 0, 0, 1.08904, 0, 1, 0, 0, 0, 0, 1, 1.42572, 1, 0, 0, 1.09224, 0, 1, 0, 0, 0, 0, 1, 0.964388, 1, 0, 0, 1.07335, 0, 1, 0, 0, 0, 0, 1, 1.39447, 1, 0, 0, 0.720588, 0, 1, 0, 0, 0, 0, 1, 1.19071, 1, 0, 0, 0.721096, 0, 1, 0, 0, 0, 0, 1, 1.77577, 1, 0, 0, 0.821445, 0, 1, 0, 0, 0, 0, 1, 1.28149, 1, 0, 0, 0.90297, 0, 1, 0, 0, 0, 0, 1, 1.91963, 1, 0, 0, 0.829283, 0, 1, 0, 0, 0, 0, 1, 1.28923, 1, 0, 0, 0.999077, 0, 1, 0, 0, 0, 0, 1, 1.34663, 1, 0, 0, 0.691218, 0, 1, 0, 0, 0, 0, 1, 0.816095)

[sub_resource type="MultiMesh" id="MultiMesh_4tkmw"]
transform_format = 1
instance_count = 69
mesh = ExtResource("7_14s3h")
buffer = PackedFloat32Array(1, 0, 0, 0.842336, 0, 1, 0, 0, 0, 0, 1, 1.94658, 1, 0, 0, 1.07786, 0, 1, 0, 0, 0, 0, 1, 1.61271, 1, 0, 0, 0.802541, 0, 1, 0, 0, 0, 0, 1, 1.70086, 1, 0, 0, 1.07557, 0, 1, 0, 0, 0, 0, 1, 1.41792, 1, 0, 0, 0.764493, 0, 1, 0, 0, 0, 0, 1, 0.846694, 1, 0, 0, 0.93016, 0, 1, 0, 0, 0, 0, 1, 1.38142, 1, 0, 0, 1.26406, 0, 1, 0, 0, 0, 0, 1, 0.807284, 1, 0, 0, 0.703696, 0, 1, 0, 0, 0, 0, 1, 1.1328, 1, 0, 0, 0.802996, 0, 1, 0, 0, 0, 0, 1, 1.95696, 1, 0, 0, 0.904201, 0, 1, 0, 0, 0, 0, 1, 1.7197, 1, 0, 0, 0.988251, 0, 1, 0, 0, 0, 0, 1, 0.746052, 1, 0, 0, 1.10425, 0, 1, 0, 0, 0, 0, 1, 1.35805, 1, 0, 0, 1.27866, 0, 1, 0, 0, 0, 0, 1, 0.816543, 1, 0, 0, 1.1702, 0, 1, 0, 0, 0, 0, 1, 1.27917, 1, 0, 0, 0.786875, 0, 1, 0, 0, 0, 0, 1, 1.06574, 1, 0, 0, 1.34992, 0, 1, 0, 0, 0, 0, 1, 1.01571, 1, 0, 0, 0.875185, 0, 1, 0, 0, 0, 0, 1, 1.57989, 1, 0, 0, 0.810154, 0, 1, 0, 0, 0, 0, 1, 1.19483, 1, 0, 0, 0.943023, 0, 1, 0, 0, 0, 0, 1, 1.26748, 1, 0, 0, 0.94144, 0, 1, 0, 0, 0, 0, 1, 1.33819, 1, 0, 0, 1.05441, 0, 1, 0, 0, 0, 0, 1, 1.36381, 1, 0, 0, 1.0979, 0, 1, 0, 0, 0, 0, 1, 1.16586, 1, 0, 0, 0.976221, 0, 1, 0, 0, 0, 0, 1, 1.86667, 1, 0, 0, 1.07174, 0, 1, 0, 0, 0, 0, 1, 1.38918, 1, 0, 0, 0.990382, 0, 1, 0, 0, 0, 0, 1, 1.62307, 1, 0, 0, 1.07995, 0, 1, 0, 0, 0, 0, 1, 1.50194, 1, 0, 0, 1.22719, 0, 1, 0, 0, 0, 0, 1, 0.846573, 1, 0, 0, 0.933087, 0, 1, 0, 0, 0, 0, 1, 1.39502, 1, 0, 0, 0.767606, 0, 1, 0, 0, 0, 0, 1, 1.21153, 1, 0, 0, 1.08881, 0, 1, 0, 0, 0, 0, 1, 1.46608, 1, 0, 0, 1.15328, 0, 1, 0, 0, 0, 0, 1, 1.13443, 1, 0, 0, 1.24095, 0, 1, 0, 0, 0, 0, 1, 1.25078, 1, 0, 0, 0.727888, 0, 1, 0, 0, 0, 0, 1, 1.19127, 1, 0, 0, 0.926236, 0, 1, 0, 0, 0, 0, 1, 1.57102, 1, 0, 0, 0.968115, 0, 1, 0, 0, 0, 0, 1, 0.989271, 1, 0, 0, 1.1543, 0, 1, 0, 0, 0, 0, 1, 0.751493, 1, 0, 0, 1.11442, 0, 1, 0, 0, 0, 0, 1, 1.05066, 1, 0, 0, 0.690233, 0, 1, 0, 0, 0, 0, 1, 1.88886, 1, 0, 0, 1.203, 0, 1, 0, 0, 0, 0, 1, 0.942984, 1, 0, 0, 0.893724, 0, 1, 0, 0, 0, 0, 1, 1.6365, 1, 0, 0, 0.889558, 0, 1, 0, 0, 0, 0, 1, 0.84779, 1, 0, 0, 0.911618, 0, 1, 0, 0, 0, 0, 1, 0.9666, 1, 0, 0, 0.951378, 0, 1, 0, 0, 0, 0, 1, 1.32792, 1, 0, 0, 1.06116, 0, 1, 0, 0, 0, 0, 1, 0.951979, 1, 0, 0, 0.885267, 0, 1, 0, 0, 0, 0, 1, 1.30376, 1, 0, 0, 1.19412, 0, 1, 0, 0, 0, 0, 1, 1.07511, 1, 0, 0, 1.19529, 0, 1, 0, 0, 0, 0, 1, 0.807793, 1, 0, 0, 0.893974, 0, 1, 0, 0, 0, 0, 1, 1.14072, 1, 0, 0, 0.887204, 0, 1, 0, 0, 0, 0, 1, 1.79669, 1, 0, 0, 1.05807, 0, 1, 0, 0, 0, 0, 1, 1.6166, 1, 0, 0, 1.15507, 0, 1, 0, 0, 0, 0, 1, 1.30532, 1, 0, 0, 1.0374, 0, 1, 0, 0, 0, 0, 1, 1.34672, 1, 0, 0, 1.20408, 0, 1, 0, 0, 0, 0, 1, 1.14076, 1, 0, 0, 0.802779, 0, 1, 0, 0, 0, 0, 1, 0.980161, 1, 0, 0, 0.932104, 0, 1, 0, 0, 0, 0, 1, 1.85678, 1, 0, 0, 1.32027, 0, 1, 0, 0, 0, 0, 1, 1.21682, 1, 0, 0, 1.18891, 0, 1, 0, 0, 0, 0, 1, 1.08614, 1, 0, 0, 0.895541, 0, 1, 0, 0, 0, 0, 1, 1.31354, 1, 0, 0, 0.793503, 0, 1, 0, 0, 0, 0, 1, 1.01129, 1, 0, 0, 0.875023, 0, 1, 0, 0, 0, 0, 1, 0.946303, 1, 0, 0, 0.968375, 0, 1, 0, 0, 0, 0, 1, 0.771898, 1, 0, 0, 0.867849, 0, 1, 0, 0, 0, 0, 1, 1.09402, 1, 0, 0, 1.20406, 0, 1, 0, 0, 0, 0, 1, 0.842556, 1, 0, 0, 0.839455, 0, 1, 0, 0, 0, 0, 1, 1.98651, 1, 0, 0, 1.2794, 0, 1, 0, 0, 0, 0, 1, 0.97366, 1, 0, 0, 0.818299, 0, 1, 0, 0, 0, 0, 1, 1.86735, 1, 0, 0, 0.835054, 0, 1, 0, 0, 0, 0, 1, 1.88808, 1, 0, 0, 1.04011, 0, 1, 0, 0, 0, 0, 1, 1.63651, 1, 0, 0, 1.25428, 0, 1, 0, 0, 0, 0, 1, 1.17262)

[sub_resource type="Shader" id="Shader_1v31y"]
code = "// NOTE: Shader automatically converted from Godot Engine 4.1.stable's StandardMaterial3D.

shader_type spatial;
render_mode blend_mix,depth_draw_opaque,cull_back,diffuse_burley,specular_schlick_ggx;
uniform vec4 albedo : source_color;
uniform sampler2D texture_albedo : source_color,filter_linear_mipmap,repeat_enable;
uniform float point_size : hint_range(0,128);
uniform float roughness : hint_range(0,1);
uniform sampler2D texture_metallic : hint_default_white,filter_linear_mipmap,repeat_enable;
uniform vec4 metallic_texture_channel;
uniform sampler2D texture_roughness : hint_roughness_r,filter_linear_mipmap,repeat_enable;
uniform float specular;
uniform float metallic;
uniform vec3 uv1_scale;
uniform vec3 uv1_offset;
uniform vec3 uv2_scale;
uniform vec3 uv2_offset;


void vertex() {
	UV=UV*uv1_scale.xy+uv1_offset.xy;
	MODELVIEW_MATRIX = VIEW_MATRIX * mat4(vec4(normalize(cross(vec3(0.0, 1.0, 0.0), INV_VIEW_MATRIX[2].xyz)), 0.0), vec4(0.0, 1.0, 0.0, 0.0), vec4(normalize(cross(INV_VIEW_MATRIX[0].xyz, vec3(0.0, 1.0, 0.0))), 0.0), MODEL_MATRIX[3]);
	MODELVIEW_NORMAL_MATRIX = mat3(MODELVIEW_MATRIX);
}






void fragment() {
	vec2 base_uv = UV;
	vec4 albedo_tex = texture(texture_albedo,base_uv);
	ALBEDO = albedo.rgb * albedo_tex.rgb;
	float metallic_tex = dot(texture(texture_metallic,base_uv),metallic_texture_channel);
	METALLIC = metallic_tex * metallic;
	vec4 roughness_texture_channel = vec4(1.0,0.0,0.0,0.0);
	float roughness_tex = dot(texture(texture_roughness,base_uv),roughness_texture_channel);
	ROUGHNESS = roughness_tex * roughness;
	SPECULAR = specular;
}
"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_31q2c"]
render_priority = 0
shader = SubResource("Shader_1v31y")
shader_parameter/albedo = Color(1, 1, 1, 1)
shader_parameter/point_size = 1.0
shader_parameter/roughness = 1.0
shader_parameter/metallic_texture_channel = null
shader_parameter/specular = 0.5
shader_parameter/metallic = 0.0
shader_parameter/uv1_scale = Vector3(1, 1, 1)
shader_parameter/uv1_offset = Vector3(0, 0, 0)
shader_parameter/uv2_scale = Vector3(1, 1, 1)
shader_parameter/uv2_offset = Vector3(0, 0, 0)

[sub_resource type="QuadMesh" id="QuadMesh_d3qpt"]
material = SubResource("ShaderMaterial_31q2c")

[sub_resource type="Resource" id="Resource_ul015"]
script = ExtResource("9_n4h14")
mesh = ExtResource("6_bd65r")
instance_count = 128.0
spawn_color = Color(0.690196, 0.854902, 0.780392, 1)

[sub_resource type="Resource" id="Resource_li1t5"]
script = ExtResource("9_n4h14")
mesh = ExtResource("7_14s3h")
instance_count = 512.0
spawn_color = Color(0.690196, 0.854902, 0.780392, 1)

[node name="TEST3" type="Node3D"]
script = ExtResource("1_4lo3h")
splash_colors = Array[Color]([Color(0.690196, 0.854902, 0.780392, 1), Color(0.890196, 0.792157, 0.647059, 1)])

[node name="Ground" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1)
mesh = SubResource("PlaneMesh_74vs6")
script = ExtResource("4_enbqc")

[node name="Area3D" type="Area3D" parent="Ground"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Ground/Area3D"]
shape = SubResource("BoxShape3D_0prmi")

[node name="grass" type="MultiMeshInstance3D" parent="Ground"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 0, -1)
multimesh = SubResource("MultiMesh_5kxa4")

[node name="grass_small" type="MultiMeshInstance3D" parent="Ground"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 0, -1)
multimesh = SubResource("MultiMesh_4tkmw")

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.875465, 0.483282, 0, -0.483282, 0.875465, 1, 0.7, 2.35)
visible = false

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 2.79946)
visible = false
mesh = SubResource("QuadMesh_d3qpt")

[node name="[TOOL] Grass" type="MultiMeshInstance3D" parent="." node_paths=PackedStringArray("terrain")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1)
script = ExtResource("9_bnb8k")
terrain = NodePath("../Ground")
variants = Array[ExtResource("9_n4h14")]([SubResource("Resource_ul015"), SubResource("Resource_li1t5")])
